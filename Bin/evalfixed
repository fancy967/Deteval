#!/usr/bin/ruby
# **************************************************************************
# evalfixed 
# 
# Author: Christian Wolf
#         christian.wolf@liris.cnrs.fr
#
# Changelog:
# 1.00 21.07.2014: -Start
#
# 1 tab = 4 spaces
#
# **************************************************************************

require 'rbconfig'

def os
    @os ||= (
        host_os = RbConfig::CONFIG['host_os']
        case host_os
        when /mswin|msys|mingw|cygwin|bccwin|wince|emc/
            :windows
        when /darwin|mac os/
            :macosx
        when /linux/
            :linux
        when /solaris|bsd/
            :unix
        else
            raise Error::WebDriverError, "unknown os: #{host_os.inspect}"
        end
    )
end

def printAndRun(com)
	$stderr.puts com
	if not system(com)
		$stderr.printf "Error code: %d\n",$?
		exit 1
	end
end

if ARGV.length()<1
	$stderr.puts ("usage: evalfixed <det-results-xml> <groundtruth-xml>")
	exit 1
end

if os == "windows"
    com="evaldetection "+ARGV.join(" ")+" > _x.xml"
else
    com="./evaldetection "+ARGV.join(" ")+" > _x.xml"
end
printAndRun(com)

if os == "windows"
    com="readdeteval _x.xml"
else
    com="./readdeteval _x.xml"
end
printAndRun(com)
